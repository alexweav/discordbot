language: elixir

elixir:
  - '1.7.3'

services:
  - docker

jobs:
  include:
    - stage: test
      install:
        - mix local.rebar --force
        - mix local.hex --force
        - mix deps.get
      script:
        - mix format --check-formatted
        - mix test --no-start

    - stage: deploy
      install:
        - docker --version
        - pip install --user awscli
        - export PATH=$PATH:$HOME/.local/bin
      script:
        - docker build -t discordbot .
